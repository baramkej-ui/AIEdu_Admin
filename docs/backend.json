{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user of the EduQuiz platform.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the User entity. Matches Firebase Auth UID."
        },
        "name": {
          "type": "string",
          "description": "User's display name."
        },
        "email": {
          "type": "string",
          "description": "User's email address.",
          "format": "email"
        },
        "role": {
          "type": "string",
          "description": "Role of the user (admin, teacher, student).",
          "enum": ["admin", "teacher", "student"]
        },
        "avatarUrl": {
          "type": "string",
          "description": "URL for the user's avatar image.",
          "format": "uri"
        }
      },
      "required": [
        "id",
        "name",
        "email",
        "role"
      ]
    },
    "Problem": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Problem",
      "type": "object",
      "description": "Represents a quiz problem.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Problem entity."
        },
        "question": {
          "type": "string",
          "description": "The text of the question."
        },
        "options": {
          "type": "array",
          "description": "Possible answer options for the question.",
          "items": {
            "type": "string"
          }
        },
        "answer": {
          "type": "string",
          "description": "The correct answer to the question."
        },
        "difficulty": {
          "type": "string",
          "description": "The difficulty level of the question.",
          "enum": ["easy", "medium", "hard"]
        },
        "topic": {
            "type": "string",
            "description": "The topic of the question."
        }
      },
      "required": [
        "id",
        "question",
        "options",
        "answer",
        "difficulty",
        "topic"
      ]
    },
    "StudentProgress": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "StudentProgress",
      "type": "object",
      "description": "Represents the progress of a student on a particular problem.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the StudentProgress entity. Typically a composite of studentId and problemId."
        },
        "studentId": {
          "type": "string",
          "description": "Reference to User (Student). (Relationship: Student 1:N StudentProgress)"
        },
        "problemId": {
          "type": "string",
          "description": "Reference to Problem. (Relationship: Problem 1:N StudentProgress)"
        },
        "solved": {
          "type": "boolean",
          "description": "Indicates whether the student solved the problem."
        },
        "correct": {
          "type": "boolean",
          "description": "Indicates whether the student answered correctly."
        },
        "timeTaken": {
          "type": "number",
          "description": "The time taken by the student to solve the problem (in seconds)."
        }
      },
      "required": [
        "id",
        "studentId",
        "problemId",
        "solved",
        "correct",
        "timeTaken"
      ]
    }
  },
  "auth": {
    "providers": [
      "password"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores public user profile information. The document ID is the same as the Firebase Auth UID.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user, matching their Firebase Auth UID."
            }
          ]
        }
      },
      {
        "path": "/problems/{problemId}",
        "definition": {
          "entityName": "Problem",
          "schema": {
            "$ref": "#/backend/entities/Problem"
          },
          "description": "Stores all quiz problems. Accessible to all authenticated users for reading. Only writable by admin or teacher roles.",
          "params": [
            {
              "name": "problemId",
              "description": "The unique identifier for the problem."
            }
          ]
        }
      },
      {
        "path": "/studentProgress/{studentProgressId}",
        "definition": {
          "entityName": "StudentProgress",
          "schema": {
            "$ref": "#/backend/entities/StudentProgress"
          },
          "description": "Stores the progress of students on specific problems. A student can only write to their own progress records.",
          "params": [
            {
              "name": "studentProgressId",
              "description": "The unique identifier for the student progress entry, typically a composite ID like {studentId}-{problemId}."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is simplified for this educational quiz app. All users are in a single 'users' collection, and all problems in a 'problems' collection. This makes querying for data straightforward. Student progress is stored in its own collection with rules to ensure students can only write to their own records. Level tests are stored in their own collection to manage test configurations. Security is managed through Firestore rules based on the 'role' field in the user's document."
  }
}
